(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],function(b){a(b,window,document)})}else{if(typeof module==="object"&&module.exports){module.exports=a(require("jquery"),window,document)}else{a(jQuery,window,document)}}})(function(d,f,g,b){var e="advancedSelect",a=1,c={element:d(),divID:"",ajax:{data:{},template:"",listUrl:"",getUrl:"",templateUrl:"",lastListUrl:""},language:{noValueText:"- No Value Required -",buttonText:"- Please Select -",multiText:"Selected",selectAllText:"Select All",deselectAllText:"Deselect All"},templateDir:"/templates/advancedSelect/",theme:"materialize",viewButton:false,viewId:"value",rowCreatedCallback:function(n,m,j){var o=n.attr("id");var k=j.options;var l=true;if(!n.hasClass("group")){if(k.multiSelect){n.on("click",{self:j,id:o},function(q){var p=q.data.self;var r=q.data.id;p.check(r)});d(g.createElement("input")).attr({id:k.element.attr("id")+"-"+o+"Input",name:k.element.attr("id")+"-"+o+"Input",type:"checkbox"}).on("click",{self:j,id:o},function(q){var p=q.data.self;var r=q.data.id;if(d(this).prop("checked")==true){d(this).prop("checked",false)}else{d(this).prop("checked",true)}p.check(r);q.stopPropagation()}).appendTo(n);l=false}if(l){n.on("click",{self:j,id:o},function(q){var p=q.data.self;var r=q.data.id;p.set(r)})}if(!k.viewButton){d("#button"+o).hide()}else{if(k.viewButton){d("#button"+o).on("click",{self:j,id:o},function(q){var r=q.data.id;var p=q.data.self;p.options.ajaxViewCall(r,p);q.preventDefault();q.stopPropagation()})}}}l=null},ajaxCall:function(l,j){var k=j.options;ajaxExtend.create().then(function(){ajaxExtend.listExecute({url:k.ajax.listUrl,type:"GET",data:null,key:"optionsData",text:"Retrieving Data",success:function(m,o,n){j.ajaxGetComplete(m,n,l)}},k.element)})},ajaxViewCall:function(l,j){var k=j.options;ajaxExtend.create().then(function(){ajaxExtend.setExecute({url:k.ajax.getUrl,type:"POST",data:{id:l},key:"getview",text:"Retrieving Details",success:function(m,o,n){j.ajaxViewComplete(l,m,n)}})})},templateCall:function(j,k,l){return templateEngine.load(j,k,l)},disabled:false,multiSelect:false,zeroValue:true,blankValue:false,zeroSet:true,blankSet:true,selectedItems:[],autoBuild:true,typed:"",templateConfig:{}};function h(l,j){this.element=d(l);var k=d.extend(true,{},c);this.options=d.extend(true,k,j);this.ns="."+e+a++;this.isGoodBrowser=Boolean(l.setSelectionRange);this._name=e}h.prototype={_init:function(){var j=this;var k=this.options;k.element=this.element;k.selectedItems=[];if(k.element.get(0).tagName=="SELECT"){var l=k.element.attr("class");if(l==b){l=""}var n=d(g.createElement("div")).addClass(l+" advancedSelect").attr("id",k.element.attr("id")+"Div");k.element.wrap(n);k.divID=d("#"+k.element.attr("id")+"Div");k.element.hide()}else{console.error("element is not a select")}k.element.data("plugin-name","advancedSelect");if(k.element.attr("multiple")=="multiple"){k.multiSelect=true}if(k.element.attr("disabled")=="disabled"){k.disabled=true}if(k.element.data("build")!=null){k.autoBuild=k.element.data("build")}if(k.element.attr("placeholder")!=""&&k.element.attr("placeholder")!=b){k.language.buttonText=k.element.attr("placeholder")}if(k.element.data("ajax-listurl")!=null){k.ajax.listUrl=k.element.data("ajax-listurl")}if(k.element.data("ajax-templateurl")!=null){k.ajax.templateUrl=k.element.data("ajax-templateurl")}if(k.element.data("ajax-geturl")!=null){k.ajax.getUrl=k.element.data("ajax-geturl")}if(k.ajax.getUrl!=""){k.viewButton=true}if(k.ajax.templateUrl==""){k.ajax.templateUrl=k.templateDir+k.theme+"/row.html"}var m={dialogId:k.element.attr("id")+"Dialog",headerId:k.element.attr("id")+"Header",searchId:k.element.attr("id")+"Search",searchFieldsId:k.element.attr("id")+"Fields",searchCellId:k.element.attr("id")+"SearchCell",searchInputId:k.element.attr("id")+"SearchInput",searchButtonId:k.element.attr("id")+"SearchButton",spanId:k.element.attr("id")+"Span",buttonId:k.element.attr("id")+"Button",infoBackId:k.element.attr("id")+"InfoBack",footerId:k.element.attr("id")+"Footer",allButtonId:k.element.attr("id")+"All",saveButtonId:k.element.attr("id")+"Save",contentId:k.element.attr("id")+"Content",resultsContentId:k.element.attr("id")+"ResultsContent",infoContentId:k.element.attr("id")+"InfoContent",elementId:k.element.attr("id")};k.templateConfig=m;j.buildInline(m).then(function(){j.buildModal(m).then(function(){if(k.autoBuild){j.build().then(function(){if(k.disabled){j.disable()}j.element.trigger("_create");return j})}else{if(k.disabled){j.disable()}j.element.trigger("_create");return j}})})},buildInline:function(l){var j=this;var k=this.options;var n=d.Deferred();var m=n.promise();m.progress(function(){k.templateCall(k.templateDir+k.theme+"/inline.html",l,k.divID).then(function(){d("#"+l.spanId).hide();d("#"+l.buttonId).on("keyup",{self:j},function(u){var p=u.data.self;var q=p.options;if(!q.multiSelect){var o=u.charCode||u.keyCode||u.which;clearTimeout(d.data(this,"typeMove"));if(o==40){var r=d("#"+q.element.attr("id")+" > option:selected").next("option");if(r.length>0){var t=r.val()}else{r=d("#"+q.element.attr("id")+" > option:first");var t=r.val()}r=null;q.element.val(t).trigger("change");t=null}else{if(o==38){var s=d("#"+q.element.attr("id")+" > option:selected").prev("option");if(s.length>0){var t=s.val()}else{s=d("#"+q.element.attr("id")+" > option:last");var t=s.val()}s=null;q.element.val(t).trigger("change");t=null}else{if(o>=48&&o<=90){q.typed+=String.fromCharCode(o);d.data(this,"typeMove",setTimeout(function(){clearTimeout(d.data(this,"typeMove"));var v=q.typed.length;d.each(q.ajax.data.results,function(w,y){var x=y.name.toLowerCase().substr(0,v);if(q.typed.toLowerCase()==x){p.set(y.value)}x=null});v=null;q.typed=""},500))}}}o=null}})});j.setButtonText(k.language.buttonText);n.resolve();j.element.trigger("buildInline")});n.notify();return m},buildModal:function(l){var j=this;var k=this.options;var n=d.Deferred();var m=n.promise();m.progress(function(){k.templateCall(k.templateDir+k.theme+"/modal.html",l,d("body")).then(function(){d("#"+l.searchInputId).on("keydown",{self:j},function(p){var o=p.data.self;setTimeout(function(){o.submit()},0)});d("#"+l.searchButtonId).on("click",{self:j},function(p){var o=p.data.self;o.open()});d("#"+l.infoBackId).on("click",{self:j},function(p){var o=p.data.self;o.load()}).hide();d("#"+l.allButtonId).html(k.language.selectAllText).on("click",{self:j},function(p){var o=p.data.self;o.selectAll()}).hide();d("#"+l.saveButtonId).on("click",{self:j},function(p){var o=p.data.self;o.save()}).hide();j.setButtonText(k.language.buttonText);j.element.trigger("buildModal");n.resolve()})});n.notify();return m},selectAll:function(){var j=this;var k=this.options;var l=k.selectedItems.length;k.selectedItems=[];if(k.ajax.data.results!==b){if(l==k.ajax.data.results.length){d("#"+k.element.attr("id")+"Dialog input[type='checkbox']").each(function(){d(this).prop("checked",false)});d("#"+k.element.attr("id")+"All").html(k.language.selectAllText)}else{d("#"+k.element.attr("id")+"Dialog input[type='checkbox']").each(function(){d(this).prop("checked",true);var m=d(this).attr("id").replace(k.element.attr("id")+"-","");m=m.replace("Input","");k.selectedItems.push(m)});d("#"+k.element.attr("id")+"All").html(k.language.deselectAllText)}}l=null;j.element.trigger("selectAll")},build:function(){var j=this;var l=d.Deferred();var k=l.promise();k.progress(function(){j.loadData().then(function(){j.element.trigger("build");l.resolve()})});l.notify();return k},reBuild:function(){var j=this;var k=this.options;var m=d.Deferred();var l=m.promise();l.progress(function(){j.searchResults(k.ajax.data).then(function(){if(k.element.val()==""||k.element.val()==null){d("#"+k.element.attr("id")+"Button").addClass("empty")}else{d("#"+k.element.attr("id")+"Button").removeClass("empty")}m.resolve()})});m.notify();return l},destroy:function(){var j=this;var k=this.options;k.element.removeData("advancedSelect");k.element.removeClass("advancedSelect");d("#"+k.element.attr("id")+"Dialog").remove();d("#"+k.element.attr("id")+"Button").remove();d("#"+k.element.attr("id")+"Span").remove();if(k.element.get(0).tagName=="SELECT"){k.element.unwrap();k.element.show()}else{k.element.html("")}d.Widget.prototype.destroy.call(this)},_initSource:function(){var j=this;var k=this.options;var m=d.Deferred();var l=m.promise();l.progress(function(){k.templateCall(k.ajax.templateUrl,{}).then(function(n){j.options.ajax.template=n;j.loadData().then(function(){m.resolve()})})});m.notify();return l},loadData:function(){var j=this;var k=this.options;var m=d.Deferred();var l=m.promise();l.progress(function(){if(k.ajax.listUrl!=""){if(k.ajax.listUrl!=k.ajax.lastListUrl||d.isEmptyObject(k.ajax.data)){k.ajax.lastListUrl=k.ajax.listUrl;k.ajaxCall(m,j)}else{m.resolve()}}else{var q=k.element.find("option[value='']");var p=k.element.find("option[value='0']");var n=k.element.find("option");var o=[];if(n.length>0){if(q.length==0&&p.length==0){k.element.prepend(d("<option></option>").attr("value","").text(k.language.buttonText))}else{k.language.buttonText=k.element.find('option[value=""]').html();j.setButtonText(k.language.buttonText)}}k.element.children().each(function(){if(d(this).children().length>0){var s=d(this).attr("value");var r=d(this).get(0).tagName.toLowerCase();o.push({value:d(this).attr("value"),name:d(this).attr("label"),parent:"0",type:r});d(this).children().each(function(){var t=d(this).get(0).tagName.toLowerCase();o.push({value:d(this).attr("value"),name:d(this).html(),parent:s,type:t})});s=null}else{var r=d(this).get(0).tagName.toLowerCase();o.push({value:d(this).attr("value"),name:d(this).html(),type:r})}});k.ajax.data.results=o;q=null;p=null;n=null;o=null;j.element.trigger("loadData");m.resolve()}});m.notify();return l},ajaxGetComplete:function(m,p,o){var j=this;var k=this.options;if(p.status==200){k.ajax.data=m;var n=[];var l=0;d.each(m.results,function(){if(this.value==""&&!d.isNumeric(this.value)){if(this.name==""){this.name=k.language.buttonText}else{j.setButtonText(this.name)}if(!k.blankValue){n.push(l)}}if(this.value==0){if(!k.zeroValue){if(n.indexOf(l)<0){n.push(l)}}}l++});l=null;d.each(n,function(q,r){m.results.splice(r,1)});n=null}j.element.trigger("loadData");o.resolve()},ajaxViewComplete:function(n,l,m){var j=this;var k=this.options;if(m.status==200){d("#"+k.templateConfig.infoContentId).show();d("#"+k.templateConfig.infoBackId).show();d("#"+k.templateConfig.resultsContentId).hide();d("#"+k.templateConfig.searchId).hide();k.templateCall(k.templateDir+k.theme+"/view.html",l).then(function(o){d("#"+k.templateConfig.infoContentId).html(o);j.element.trigger("view",{id:n})})}},view:function(k){var j=this;j.options.ajaxViewCall(k,j)},searchResults:function(l){var j=this;var k=this.options;var n=d.Deferred();var m=n.promise();m.progress(function(){if(l.results!==b){var o=function(){d("#"+k.element.attr("id")+"ResultsContent").html("");d("#"+k.element.attr("id")+"ResultsContent").css({"max-height":"100%"});d.each(l.results,function(x,v){var s=false;var q=false;var w=k.ajax.template;if((v.value==""||v.value==0)&&v.name.toLowerCase().indexOf("please select")>-1){v.name=k.language.noValueText}var t="option";if(v.type!==b){t=v.type}v.type=t;if((v.parent===b||v.parent!=0)&&t!="optgroup"){v.buttonId="button"+v.value;d.each(v,function(B,A){if(A===b){A=""}if(A==0){q=true}if(A.toString()==""){s=true}});k.templateCall(w,v).then(function(A){w=A})}else{var p=v.value;if(p===b){p=v.id}var y=v.name;if(y===b){y=v.title}w='<div class="group" id="'+p+'"><h3>'+y+"</h3></div>"}var u=true;if((s==true&&k.blankValue==false)||(q==true&&k.zeroValue==false)){u=false}if(u){if(v.parent===b){var r=0}else{var r=v.parent}var z=d(w);if(d.isNumeric(v.value)){v.value=parseInt(v.value)}if(r==0){d("#"+k.element.attr("id")+"ResultsContent").append(z)}else{d("#"+k.element.attr("id")+"ResultsContent").find('[id="'+r+'"]').append(z)}k.rowCreatedCallback(z,v,j);j.element.trigger("rowCreated",{row:z,data:v,self:j});r=null;z=null}s=null;q=null;u=null;w=null});j.resizeResults();j.element.trigger("searchresults");n.resolve()};if(k.ajax.template==""){j._initSource().then(function(){o()})}else{o()}}else{j.element.trigger("searchresults");n.resolve()}});n.notify();return m},resizeResults:function(){var m=this;var n=this.options;d("#"+n.element.attr("id")+"ResultsContent").css({"max-height":"100%"});var p=d("#"+n.element.attr("id")+"Dialog").find(".modal-dialog").outerHeight(true)-d("#"+n.element.attr("id")+"Dialog").find(".modal-dialog").height();var j=d(f).height()-p;j-=d("#"+n.element.attr("id")+"Header").outerHeight(true);j-=d("#"+n.element.attr("id")+"Footer").outerHeight(true);var k=d("#"+n.element.attr("id")+"ResultsContent").outerHeight(true)-d("#"+n.element.attr("id")+"ResultsContent").height();j-=k;var l=0;var o=0;d.each(d("#"+n.element.attr("id")+"ResultsContent").children(),function(){if(d(this).children(":not(i)").length>0){l+=d(this).outerHeight(true);o+=d(this).outerHeight(true);if(l>j){l-=d(this).outerHeight(true)}}else{l+=d(this).outerHeight(true);o+=d(this).outerHeight(true);if(l>j){l-=d(this).outerHeight(true)}}});if(j<o){d("#"+n.element.attr("id")+"ResultsContent").css({"max-height":l+"px","overflow-y":"auto"})}else{d("#"+n.element.attr("id")+"ResultsContent").css({"max-height":"auto","overflow-y":"none"})}d("#"+n.element.attr("id")+"SearchInput").focus();p=null;k=null;l=null;o=null;j=null;m.element.trigger("resizeResults")},setOption:function(l,m){var j=this;var k=this.options;d.Widget.prototype._setOption.apply(this,arguments);j.element.trigger("setOption")},setOptions:function(l){var j=this;var k=this.options;this.options=d.extend(true,k,l);if(l.ajax["data"]!==b){if(d.isEmptyObject(l.ajax["data"])){this.options.ajax.data={}}}j.element.trigger("setOptions")},close:function(){var j=this;var k=this.options;if(k.theme=="bootstrap"){d("#"+k.element.attr("id")+"Dialog").modal("hide")}else{if(k.theme="materialize"){d("#"+k.element.attr("id")+"Dialog").closeModal()}}j.element.trigger("close")},check:function(n){var j=this;var m=j.options;var l=d("#"+m.element.attr("id")+"-"+n+"Input");if(d.isNumeric(n)){n=parseInt(n)}var k=m.selectedItems.indexOf(n);if(k>-1){m.selectedItems.splice(k,1)}if(l.prop("checked")==true){l.prop("checked",false)}else{l.prop("checked",true);m.selectedItems.push(n)}if(m.ajax.data.results!==b){if(m.selectedItems.length==m.ajax.data.results.length){d("#"+m.element.attr("id")+"All").html(m.language.deselectAllText)}else{d("#"+m.element.attr("id")+"All").html(m.language.selectAllText)}}if(m.selectedItems.length==0&&m.blankSet==false){d("#"+m.element.attr("id")+"Save").attr("disabled","disabled")}else{d("#"+m.element.attr("id")+"Save").removeAttr("disabled")}n=null;l=null;j.element.trigger("check",0,{self:j})},set:function(k){var u=this;var v=this.options;var t=[];if(k!=""&&k!=null){if(typeof k=="string"||typeof k=="number"){t=String(k).split(",")}else{if(typeof k=="object"){t=k}}t=d.map(t,function(w){if(d.isNumeric(w)){return parseInt(w)}else{return w}})}var l=false;v.element.find("option").each(function(){var w=d(this).val();if(d.isNumeric(w)){w=parseInt(w)}if(d.inArray(w,t)>-1){l=true}});if(l||(k==""&&v.blankSet==true)){var m=[];var p=v.element.val();if(p!=""&&p!=null){if(typeof p=="string"||typeof p=="number"){m=String(p).split(",")}else{if(typeof p=="object"){m=p}}m=d.map(m,function(w){if(d.isNumeric(w)){return parseInt(w)}else{return w}})}p=null;if(m!==null){m.sort()}if(t!==null){t.sort()}if(v.element.children().length>0){var r=true;if(v.element.children().length==1){if((v.element.children().eq(0).val()==""&&v.blankSet==false)||(v.element.children().eq(0).val()=="0"&&v.zeroSet==false)){r=false}}if(r){v.selectedItems=t;if(JSON.stringify(m)!==JSON.stringify(t)){v.element.val(t).trigger("change");var j=v.element.closest("form");if(j.length>0){try{if(v.element.valid()){var s=v.element.rules();var q=false;for(var o in s){q=true}if(q){v.element.closest("form").valid()}q=null;s=null}}catch(n){}}j=null}}r=null}if(k==""){d("#"+v.element.attr("id")+"Button").addClass("empty")}else{d("#"+v.element.attr("id")+"Button").removeClass("empty")}u.close()}u.getText(v.ajax.data,t,true);t=null;k=null;m=null;l=null;u.element.trigger("set",{self:u})},load:function(){var j=this;var k=this.options;var m=d.Deferred();var l=m.promise();l.progress(function(){d("#"+k.element.attr("id")+"InfoContent").hide();d("#"+k.element.attr("id")+"InfoBack").hide();d("#"+k.element.attr("id")+"ResultsContent").show();d("#"+k.element.attr("id")+"Search").show();var o=[];var n=k.element.val();if(typeof n=="string"||typeof n=="number"){var o=String(n).split(",")}else{if(typeof n=="object"){var o=[];if(n!=null){o=n}}}n=null;d("#"+k.element.attr("id")+"ResultsContent").children().each(function(){d(this).removeClass("selected");if(d(this).children().length>0){d(this).children().each(function(){d(this).removeClass("selected")})}});if(k.multiSelect){d("#"+k.element.attr("id")+"Dialog").find("input[type='checkbox']:checked").each(function(){d(this).prop("checked",false)});d("#"+k.element.attr("id")+"All").show();d("#"+k.element.attr("id")+"Save").show()}else{d("#"+k.element.attr("id")+"All").hide();d("#"+k.element.attr("id")+"Save").hide()}d.each(o,function(p,q){if(k.multiSelect){d("#"+k.element.attr("id")+"-"+q+"Input").prop("checked",true)}else{d("#"+k.element.attr("id")+"ResultsContent").find('[id="'+q+'"]').addClass("selected")}});o=null;j.element.trigger("load");m.resolve()});m.notify();return l},save:function(){var j=this;var k=this.options;j.set(k.selectedItems);j.element.trigger("save")},getText:function(n,m){var k=this;var l=this.options;var j=l.language.buttonText;if(typeof(n)!=="object"){return}n=n.results;if(m.length!=0&&n!==b){if(m.length==n.length&&l.multiSelect==true){j=l.language.selectedAllText}else{if(m.length>1){j=m.length+" "+l.language.multiText}else{d.each(n,function(o,p){if(p.value==m[0]){j=p.name}})}}}d("#"+l.element.attr("id")+"Span").html(j);k.setButtonText(j);j=null;k.element.trigger("getText")},search:function(k){k=String(k);var j=this;var l=this.options;var p=[];var n=l.element.attr("id")+"-";var o=d.extend(true,{},l.ajax.data);var m=[];d("#"+l.element.attr("id")+"Dialog input[type='checkbox']:checked").each(function(){var q=d(this).parent().attr("id").replace(n,"");m.push(q);q=null;n=null});if(k!=""){d.each(o.results,function(q,r){if(r.parent===b||r.parent!=0){var s=r;delete (s.parent);s.incorrect=0;s.correct=0;s.jw=0;s.distance=0;s.word_match=0;d.each(r,function(x,w){if(x!="id"&&x!="value"&&x!="parent"){w=String(w);var A=w.toLowerCase();var u=j.levDist(k,A);var y=j.letter_match(k,A);var z=j.jaroWinkle(k,A);var B=j.levDistRatio(k,A);var t=j.word_match(k,A);s.incorrect=(s.incorrect<u)?u:s.incorrect;s.correct=(s.correct<y)?y:s.correct;s.jw=(s.jw<z)?z:s.jw;s.distance=(s.distance<B)?B:s.distance;s.word_match=(s.word_match<t)?t:s.word_match;A=null;u=null;y=null;z=null;B=null;t=null}});p.push(s);s=null}});p.sort(function(x,w){var v=parseInt(w.word_match);var u=parseInt(x.word_match);if(v!=u){return v-u;v=null;u=null}var t=parseInt(w.correct);var s=parseInt(x.correct);if(t!=s){return t-s}var z=parseInt(w.jw,10);var y=parseInt(x.jw,10);if(z!=y){return z-y}var r=parseInt(w.distance,10);var q=parseInt(x.distance,10);if(r!=q){return r-q}return parseInt(x.incorrect)-parseInt(w.incorrect)});o.results=p;p=null}j.element.trigger("search");j.searchResults(o).then(function(){d.each(m,function(q,r){if(l.multiSelect){d("#"+l.element.attr("id")+"-"+r+"Input").prop("checked",true)}})});m=null;o=null},levDistRatio:function(l,k){var j=this;if(l.length>k.length){var m=l.length}else{var m=k.length}return Math.round((1-j.levDist(l,k)/m)*100)},levDist:function(A,z){var w=[];var k=A.length;var o=z.length;if(k==0){return o}if(o==0){return k}for(var r=k;r>=0;r--){w[r]=[]}for(var r=k;r>=0;r--){w[r][0]=r}for(var q=o;q>=0;q--){w[0][q]=q}for(var r=1;r<=k;r++){var p=A.charAt(r-1);for(var q=1;q<=o;q++){if(r==q&&w[r][q]>4){return k}var v=z.charAt(q-1);var l=(p==v)?0:1;var u=w[r-1][q]+1;var y=w[r][q-1]+1;var x=w[r-1][q-1]+l;if(y<u){u=y}if(x<u){u=x}w[r][q]=u;if(r>1&&q>1&&p==z.charAt(q-2)&&A.charAt(r-2)==v){w[r][q]=Math.min(w[r][q],w[r-2][q-2]+l)}y=null;x=null;u=null;v=null;l=null}p=null}return w[k][o]},word_match:function(l,j){var k=l.split(" ");var n=j.split(" ");var m=0;d.each(k,function(o){d.each(n,function(p){if(n[p]==k[o]){m++}})});return m},letter_match:function(v,u){var p=v.split(" ");var w=[];for(var o=0;o<p.length;o++){var k="";var l=p[o].split("");for(var n=0;n<l.length;n++){var m=l[n];k+=m;m=null;if(k.length>1){var r=new RegExp(k,"gi");var q=u.match(r);if(q!=null&&q.length>0){w.push(q)}}}var k=p[o];for(var n=l.length;n>0;n--){k=k.substring(1,k.length);if(k.length>1){var r=new RegExp(k,"gi");var q=u.match(r);if(q!=null&&q.length>0){w.push(q)}r=null;q=null}}k=null;l=null}p=null;return w.length},jaroWinkle:function(E,D){var C=E;var A=D;var v,B,z,u,y,w,x,r,o,q,j;C.length>A.length&&(A=[A,C],C=A[0],A=A[1]);u=~~Math.max(0,A.length/2-1);y=[];w=[];B=o=0;for(j=C.length;o<j;B=++o){for(v=C[B],r=Math.max(0,B-u),x=Math.min(B+u+1,A.length),z=q=r;r<=x?q<x:q>x;z=r<=x?++q:--q){if(null==w[z]&&v===A[z]){y[B]=v;w[z]=A[z];break}}}y=y.join("");w=w.join("");if(z=y.length){B=x=u=0;for(r=y.length;x<r;B=++x){v=y[B],v!==w[B]&&u++}B=w=y=0;for(x=C.length;w<x;B=++w){if(v=C[B],v===A[B]){y++}else{break}}C=(z/C.length+z/A.length+(z-~~(u/2))/z)/3;C+=0.1*Math.min(y,4)*(1-C)}else{C=0}A,v,B,z,u,y,w,x,r,o,q,j=null;return C*100},submit:function(){var j=this;var k=this.options;var l=d("#"+k.element.attr("id")+"SearchInput").val().toLowerCase();j.search(l);j.element.trigger("submit")},clear:function(){var j=this;var k=this.options;k.element.val("");j.load("");j.setButtonText(k.language.buttonText);j.element.trigger("clear")},setButtonText:function(l){var j=this;var k=this.options;d("#"+k.element.attr("id")+"Button").html(l);d("#"+k.element.attr("id")+"Span").html(l);d(g.createElement("span")).attr("id",k.element.attr("id")+"Icon").addClass("caret").appendTo(d("#"+k.element.attr("id")+"Button"));j.element.trigger("setButtonText")},disable:function(){var j=this;var k=this.options;d("#"+k.element.attr("id")+"Button").hide();d("#"+k.element.attr("id")+"Span").show();d("#"+k.element.attr("id")+"Div").attr("disabled","disabled");k.disabled=true;j.element.trigger("disable")},enable:function(){var j=this;var k=this.options;d("#"+k.element.attr("id")+"Button").show();d("#"+k.element.attr("id")+"Span").hide();d("#"+k.element.attr("id")+"Div").removeAttr("disabled");k.disabled=false;j.element.trigger("enable")},get:function(){var k=this;var l=this.options;var j=[];if(l.multiSelect){j=l.element.val()}else{j.push(l.element.val())}return j;j=null;k.element.trigger("get")},add:function(l,n,p){var j=this;var k=this.options;if(p===b){p=0}var m=false;if(k.ajax.data.results!==b){d.each(k.ajax.data.results,function(r,q){if(q.value==n){m=true;return false}});if(!m){k.ajax.data.results.push({name:l,value:n,parent:p,type:"option"})}var o=d(g.createElement("option")).attr("value",n).html(l);if(p==0){k.element.append(o)}else{k.element.find("optgroup").each(function(){if(d(this).attr("data-value")==p){d(this).append(o)}})}o=null}p=null;j.element.trigger("add")},remove:function(l){var j=this;var k=this.options;var m=k.element.attr("id");if(d.isNumeric(l)){l=parseInt(l)}d("#"+m+"ResultsContent").children().each(function(){var n=d(this).attr("id");n=n.replace(k.element.attr("id")+"-","");if(d.isNumeric(n)){n=parseInt(n)}if(n==l){d(this).remove()}n=null});d.each(k.element.find("option"),function(){var n=this.value;if(d.isNumeric(n)){n=parseInt(n)}if(n==l){d(this).remove();if(d.inArray(l,k.selectedItems)>=0){j.clear()}}});m=null;j.element.trigger("remove")},show:function(){var j=this;var k=this.options;d("#"+k.element.attr("id")+"Button").show();j.element.trigger("show")},hide:function(){var j=this;var k=this.options;d("#"+k.element.attr("id")+"Button").hide();j.element.trigger("hide")},displayValue:function(){var j=this;var k=this.options;return d("#"+k.element.attr("id")+"Span").html()},focus:function(){var j=this;var k=this.options;d("#"+k.element.attr("id")+"Button").focus();j.element.trigger("focus")},getData:function(){var j=this;var k=this.options;return k.ajax.data}};d.fn[e]=function(k){var j=arguments;if(k===b||typeof k==="object"){var l=[];this.each(function(){if(!d.data(this,"plugin_"+e)){var n=new h(this,k);n._init();d.data(this,"plugin_"+e,n)}});return d.when.apply(null,l)}else{if(typeof k==="string"&&k[0]!=="_"){var m;this.each(function(){var n=d.data(this,"plugin_"+e);if(n instanceof h&&typeof n[k]==="function"){m=n[k].apply(n,Array.prototype.slice.call(j,1))}if(k==="destroy"){d.data(this,"plugin_"+e,null)}});return m!==b?m:this}}};d.fn[e].version="0.5.1";d.fn[e].author="Marc Evans (moridiweb)";var i=d.fn.val;d.fn.val=function(k){if(typeof k=="undefined"){return i.call(this)}else{var j=i.call(this,k);if(d(this[0]).data("plugin-name")=="advancedSelect"){d(this[0]).advancedSelect("set",k)}return j}}});